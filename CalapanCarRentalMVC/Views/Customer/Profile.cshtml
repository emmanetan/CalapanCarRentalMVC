@model CalapanCarRentalMVC.Models.Customer
@{
    ViewData["Title"] = "My Profile";
    Layout = "_Layout";
}

<div class="page-header">
    <div class="d-flex justify-content-between align-items-center">
        <div>
         <h1><i class="fas fa-user-circle me-2"></i>My Profile</h1>
      <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
          <li class="breadcrumb-item"><a asp-action="Dashboard">Dashboard</a></li>
   <li class="breadcrumb-item active">My Profile</li>
    </ol>
            </nav>
        </div>
    </div>
</div>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <i class="fas fa-check-circle me-2"></i>@TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

@if (TempData["Error"] != null)
{
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
  <i class="fas fa-exclamation-circle me-2"></i>@TempData["Error"]
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
}

<div class="row">
    <!-- Profile Information -->
    <div class="col-lg-8 mb-4">
  <div class="dashboard-widget">
   <div class="d-flex justify-content-between align-items-center mb-4">
   <h5><i class="fas fa-user me-2"></i>Personal Information</h5>
              <button type="button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#editProfileModal">
   <i class="fas fa-edit me-1"></i>Edit Profile
              </button>
          </div>

         <div class="row mb-3">
   <div class="col-md-6">
         <div class="profile-info-item">
      <label class="text-muted mb-1"><i class="fas fa-user me-2"></i>First Name</label>
          <p class="fw-bold">@Model.FirstName</p>
         </div>
          </div>
  <div class="col-md-6">
     <div class="profile-info-item">
   <label class="text-muted mb-1"><i class="fas fa-user me-2"></i>Last Name</label>
       <p class="fw-bold">@Model.LastName</p>
       </div>
                </div>
    </div>

        <div class="row mb-3">
     <div class="col-md-6">
   <div class="profile-info-item">
     <label class="text-muted mb-1"><i class="fas fa-envelope me-2"></i>Email Address</label>
     <p class="fw-bold">@Model.Email</p>
   </div>
  </div>
         <div class="col-md-6">
   <div class="profile-info-item">
     <label class="text-muted mb-1"><i class="fas fa-phone me-2"></i>Phone Number</label>
       <p class="fw-bold">@Model.PhoneNumber</p>
               </div>
       </div>
   </div>

            <div class="row mb-3">
     <div class="col-12">
          <div class="profile-info-item">
 <label class="text-muted mb-1"><i class="fas fa-map-marker-alt me-2"></i>Address</label>
       <p class="fw-bold">@Model.Address</p>
      </div>
    </div>
        </div>

      <div class="row">
        <div class="col-md-6">
    <div class="profile-info-item">
      <label class="text-muted mb-1"><i class="fas fa-id-card me-2"></i>License Number</label>
       <p class="fw-bold">@Model.LicenseNumber</p>
  </div>
          </div>
              <div class="col-md-6">
              <div class="profile-info-item">
     <label class="text-muted mb-1"><i class="fas fa-calendar-check me-2"></i>License Expiry Date</label>
   <p class="fw-bold">
    @Model.LicenseExpiryDate.ToString("MMMM dd, yyyy")
  @if (Model.LicenseExpiryDate < DateTime.Now)
     {
     <span class="badge bg-danger ms-2">Expired</span>
              }
else if (Model.LicenseExpiryDate < DateTime.Now.AddMonths(1))
   {
         <span class="badge bg-warning ms-2">Expiring Soon</span>
      }
         else
       {
           <span class="badge bg-success ms-2">Valid</span>
  }
         </p>
    </div>
     </div>
      </div>

            <hr class="my-3" />

            <div class="profile-info-item">
       <label class="text-muted mb-1"><i class="fas fa-clock me-2"></i>Member Since</label>
        <p class="fw-bold">@Model.CreatedAt.ToString("MMMM dd, yyyy")</p>
            </div>
        </div>
    </div>

    <!-- Account Statistics -->
    <div class="col-lg-4 mb-4">
        <div class="dashboard-widget">
   <h5 class="mb-4"><i class="fas fa-chart-bar me-2"></i>Account Statistics</h5>
          
    <div class="stat-card mb-3">
        <div class="d-flex justify-content-between align-items-center">
                  <div>
     <p class="text-muted mb-1">Total Rentals</p>
                   <h4>@Model.Rentals.Count()</h4>
         </div>
  <i class="fas fa-file-contract fa-2x text-primary"></i>
 </div>
            </div>

       <div class="stat-card mb-3">
      <div class="d-flex justify-content-between align-items-center">
           <div>
           <p class="text-muted mb-1">Active Rentals</p>
<h4 class="text-success">@Model.Rentals.Count(r => r.Status == "Active")</h4>
       </div>
       <i class="fas fa-check-circle fa-2x text-success"></i>
           </div>
            </div>

  <div class="stat-card">
                <div class="d-flex justify-content-between align-items-center">
         <div>
    <p class="text-muted mb-1">Completed</p>
       <h4 class="text-info">@Model.Rentals.Count(r => r.Status == "Completed")</h4>
               </div>
        <i class="fas fa-check-double fa-2x text-info"></i>
    </div>
            </div>
        </div>

        <div class="dashboard-widget mt-3">
    <h5 class="mb-3"><i class="fas fa-cog me-2"></i>Quick Actions</h5>
          <div class="d-grid gap-2">
                <a asp-action="MyRentals" class="btn btn-outline-primary">
   <i class="fas fa-list me-2"></i>View My Rentals
    </a>
                <a asp-controller="Cars" asp-action="Index" class="btn btn-outline-success">
           <i class="fas fa-car me-2"></i>Browse Cars
   </a>
     <a asp-action="Dashboard" class="btn btn-outline-info">
    <i class="fas fa-tachometer-alt me-2"></i>Go to Dashboard
    </a>
   </div>
        </div>
    </div>
</div>

<!-- Edit Profile Modal -->
<div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <form asp-controller="Customer" asp-action="UpdateProfile" method="post">
    <div class="modal-header">
          <h5 class="modal-title" id="editProfileModalLabel">
             <i class="fas fa-edit me-2"></i>Edit Profile
         </h5>
     <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
                <div class="modal-body">
                 <input type="hidden" asp-for="CustomerId" />
              <input type="hidden" asp-for="CreatedAt" />

            <div class="row">
   <div class="col-md-6 mb-3">
          <label asp-for="FirstName" class="form-label">First Name</label>
          <input asp-for="FirstName" class="form-control" required />
           <span asp-validation-for="FirstName" class="text-danger"></span>
            </div>
           <div class="col-md-6 mb-3">
  <label asp-for="LastName" class="form-label">Last Name</label>
       <input asp-for="LastName" class="form-control" required />
     <span asp-validation-for="LastName" class="text-danger"></span>
             </div>
               </div>

 <div class="row">
     <div class="col-md-6 mb-3">
             <label asp-for="Email" class="form-label">Email Address</label>
           <input asp-for="Email" type="email" class="form-control" required />
   <span asp-validation-for="Email" class="text-danger"></span>
              </div>
             <div class="col-md-6 mb-3">
           <label asp-for="PhoneNumber" class="form-label">Phone Number</label>
   <input asp-for="PhoneNumber" type="tel" class="form-control" required />
           <span asp-validation-for="PhoneNumber" class="text-danger"></span>
</div>
                    </div>

           <div class="mb-3">
          <label asp-for="Address" class="form-label">Address</label>
        <textarea asp-for="Address" class="form-control" rows="2" required></textarea>
    <span asp-validation-for="Address" class="text-danger"></span>
     </div>

           <div class="row">
          <div class="col-md-6 mb-3">
    <label asp-for="LicenseNumber" class="form-label">License Number</label>
          <input asp-for="LicenseNumber" class="form-control" required />
       <span asp-validation-for="LicenseNumber" class="text-danger"></span>
        </div>
     <div class="col-md-6 mb-3">
       <label asp-for="LicenseExpiryDate" class="form-label">License Expiry Date</label>
    <input asp-for="LicenseExpiryDate" type="date" class="form-control" required />
    <span asp-validation-for="LicenseExpiryDate" class="text-danger"></span>
         </div>
       </div>

          <div class="alert alert-info">
   <i class="fas fa-info-circle me-2"></i>
     <strong>Note:</strong> Ensure all information is accurate, especially your license details, as they are required for car rentals.
      </div>
         </div>
                <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
             <i class="fas fa-times me-1"></i>Cancel
     </button>
         <button type="submit" class="btn btn-primary">
           <i class="fas fa-save me-1"></i>Save Changes
  </button>
           </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
}
